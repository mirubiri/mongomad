//Si hay algun timer funcionando lo paro para evitar datos erroneos
var timers = new Array();
stopTimers(timers);


//Modifico el contenido principal con las ofertas

$("#navigation_bar")
.html("<%=j render :partial => 'layouts/global_partials/navigation_bar' %>");

$("#ppal_container")
.html("<%=j render :partial => 'offers/partials/offer' %>")
.masonry('destroy');


// Zona reservada al codigo para actualizar las nuevas ofertas a tiempo real

offerListenerLoop();

function offerListenerLoop() {
  var lugar =locationName();

  if (lugar == "offers") {
    timers.push(setTimeout(updateOffers, 2000));
  }
}

function updateOffers() {
  var after = $('#ppal_container > .offer:first').attr('data-id');
  var scriptUrl = "<%= offers_updateOffers_url %>";
  //alert(scriptUrl+"?after="+ after);
  $.getScript(scriptUrl+"?after="+ after);
  timers.push(setTimeout(offerListenerLoop, 2000));
}