<% if (user_visited_offers.count != 0)%>
  <% user_visited_offers.reverse_each do |offer| %>
    <div class="offer" id="<%= offer_id(offer) %>" data-id="<%= offer_datetime(offer) %>">

      <div class="offer_header">
        <%= offer_composer_name(offer) %>
      </div>

      <div class="offer_things">
        <div class="recieved">
          <% offer_composer_products(offer).each do |product| %>
            <div class="image_container">
              <%= product_image(product) %>
              <div class="artistic_layer_big"></div>
              <div class="description">
                <%= product_name(product) %>
              </div>
            </div>
          <% end %>
        </div>
        <div class="given">
          <% offer_receiver_products(offer).each do |product| %>
            <div class="image_container">
              <%= product_image(product) %>
              <div class="quantity_container"><%= product_quantity(product) %></div>
              <div class="artistic_layer_small"></div>
            </div>
          <% end %>
        </div>
      </div>

      <div class="offer_info">
        <div class="profile_image">
          <%= link_to offer_composer_image(offer),
            :controller => "users",
            :action => "show",
            :id => offer_composer_id(offer)
          %>
        </div>
        <div class="description">
          <div class="offer_message">
            <%= offer_message(offer) %>
          </div>
        </div>

        <div class="offer_buttons" id="offer_buttons_navigation">
          <% if user_logged_id != offer_composer_id(offer) %>
            <% if user_logged_id == user_visited_id %>
              <%= form_for [current_user,@negotiation], :remote => true do |form| %>
                <input type="hidden" name="offer_id" value="<%= offer_id(offer)%>" />
                <div class="offer_button">
                  <a href="<%= user_negotiations_path(@user)%>"><%= form.submit "negociar", :class => "btn btn-small btn-wide disabled", :id => "negotiate_button" %></a>
                </div>
              <% end %>
            <% else %>
              <%= form_for [current_user,@negotiation], :remote => true do |form| %>
                <input type="hidden" name="offer_id" value="<%= offer_id(offer)%>" />
                <div class="offer_button">
                  <a href="<%= user_negotiations_path(@user)%>"><%= form.submit "para mi", :class => "btn btn-small btn-wide disabled", :id => "negotiate_button" %></a>
                </div>
              <% end %>
            <% end %>
          <% else %>
            <% if can? :update, offer %>
              <%= link_to "edit",
                      {:controller => "offers",
                      :action => "edit",
                      :user_id => current_user.id,
                      :id => offer.id},
                      {:remote => true,
                       :id => "edit_offer_link"} %>
            <% end %>
          <% end %>
        </div>
        <!--
        <div class="offer_date hidden">
          <%#= offer_datetime(offer) %>
        </div>
        -->
      </div>
    </div>
  <% end %>
<% else %>
  <div class="no_elements">
    <p>El usuario no tiene ninguna oferta actualmente</p>
  </div>
<% end %>