//Si hay algun timer funcionando lo paro para evitar datos erroneos
if (variableNotDefined(timers) === true){var timers = new Array();}
stopTimers(timers);


//Contenido que debe cargar esta seccion: NEGOCIACIONES
if ($("#user_alerts_list").length){
  $("#leftContainer").replaceWith("<%=j render :partial => 'layouts/global_partials/user_container' %>");
  $("#rightContainer").replaceWith("<%=j render :partial => 'layouts/global_partials/main_container' %>");
}else{
  $("#navigation_bar").html("<%=j render :partial => 'layouts/global_partials/navigation_bar' %>");
}

$("#ppal_container").html("<%=j render :partial => 'negotiations/partials/negotiation' %>");


//Carga sus funciones especificas de dibujado
destroyMasonry();
$('.negotiation').regulateWidth();
$('.negotiation').maximizeConversationWidth();
$('.negotiation').maximizeConversationsHeights();
$('.negotiation').activateNegotiationButtons();
$('.negotiation').disableDoubleScrolling();
$('.negotiation').focusNegotiationWritebox();
$('.negotiation').scrollConversation();


// Zona reservada el codigo para actualizar los comentarios de las negociaciones

//negotiationListenerLoop();

function negotiationListenerLoop() {
  var lugar =locationName();

  if (lugar == "negotiations") {
    timers.push(setTimeout(updateComments, 1000));
  }
}

function updateComments() {
  var scriptUrl = "<%= negotiations_updateComments_url %>";
  $.getScript(scriptUrl);
  timers.push(setTimeout(negotiationListenerLoop, 1000));
}