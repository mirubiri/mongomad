//Agregamos el elemento en el ppal_container con una transicion para que el usuario vea como se a√±ade
$("#navigation_bar").html("<%=j render :partial => 'application/navigation_bar' %>");
$("#leftContainer").html("<%=j render :partial => 'application/user_container' %>");
$("#ppal_container").html("<%=j render 'negotiation_list' %>");

$('.negotiation').regulateAsNegotiation();

$("#ppal_container")
.prepend("<%= escape_javascript(render template: 'negotiations/show', :locals => {:negotiation => negotiation}).html_safe %>")
.children()
.first()
.regulateAsNegotiation()
.scrollConversation()
.addClass("new_request_style")
.css('opacity', 0)
.hide()
.slideDown()
.animate(
  { opacity: 1 },
  { queue: false, duration: 1500 }
)
.animate({backgroundColor: '#ffffff'}, 800, function(){
  $(this).removeClass("new_request_style");
});


//Elimino los id's de las negociaciones y su attr class generados por el helper de form
$('.negotiation').find('form').removeAttr('id').removeAttr('class');

//Controlo el evento de ponerse encima de un item
$('.image_container').hideTitle();

//Si le doy al enter en cualquier conversacion, envia el texto si el textarea esta activado claro
$('.txt_area_writer').keypress(function(event) {
  if (event.which == 13) {
    //alert("enter key pressed");
    event.preventDefault();
    $(this).closest("form").submit();
  }
});


