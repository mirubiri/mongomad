

(function ($)
{
  $.fn.maximizeConversationWidth = function(){

    var negotiationWidth = $(this).width();
    var proposalOfNegotiationWith = $(this).find('.negotiation_offer').width();
    var conversationWidth = negotiationWidth - proposalOfNegotiationWith;

    $(this).find('.dialog_container').css({'width': conversationWidth + 'px'});

    return $(this);
  };

})(jQuery);


(function ($)
{
  $.fn.maximizeConversationsHeights = function(){

    var alturaOferta = $(this).find(".negotiation_offer").outerHeight(true);
    var alturaWritingBox = $(this).find(".writting_box").outerHeight(true);
    var alturaNegociacion = $(this).height() - alturaWritingBox;
    $(this).css({'max-height': (alturaOferta + 2) +'px'});
    $(this).find(".dialog_container").css({'height': (alturaOferta) +'px'}).css({'max-height': (alturaOferta) +'px'});

    $(this).find('.conversation').css({'height':alturaNegociacion + 'px'});

    return $(this);
  };

})(jQuery);


(function ($)
{
  $.fn.activateNegotiationButtons = function(){

    $(this).hover(
       function () {
          $(this).find('.btn').removeClass("disabled");
       },
       function () {
          $(this).find('.btn').addClass("disabled");
       }
    );

    return $(this);
  };

})(jQuery);


(function ($)
{
  $.fn.disableDoubleScrolling = function(){

    $(this).find('.conversation').hover(
       function () {
          if($(this).has_scrollbar()){
            $("body").css("overflow", "hidden");
          }
       },
       function () {
          if($(this).has_scrollbar()){
            $("body").css("overflow", "auto");
          }
       }
    );

    return $(this);
  };

})(jQuery);


(function ($)
{
  $.fn.focusNegotiationWritebox = function(){

    $(this).on('click', function() {
      $(this).find("#message_writer").focus();
    });

    return $(this);
  };

})(jQuery);


(function ($)
{
  $.fn.scrollConversation = function(){

    $(this).find(".conversation").scrollTop($(this).height());

    return $(this);
  };

})(jQuery);

/*
function reloadDialogContainerWidth(){
  var anchuraTotal = $('.negotiation').first().width();
  var anchuraOfferSide = $('.negotiation > .negotiation_offer').first().width();
  var anchuraDialog = anchuraTotal - anchuraOfferSide;
  $('.negotiation > .dialog_container').css({'width': anchuraDialog +'px'});
}
*/

(function($) {
    $.fn.has_scrollbar = function() {
        var divnode = this.get(0);
        if(divnode.scrollHeight > divnode.clientHeight)
            return true;
    }
})(jQuery);